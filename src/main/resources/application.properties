spring.application.name=mapapp

# ===== PostgreSQL datasource =====
spring.datasource.url=jdbc:postgresql://localhost:5432/map
spring.datasource.username=postgres
spring.datasource.password=admin
spring.datasource.driver-class-name=org.postgresql.Driver

# ===== JPA / Hibernate settings =====
spring.jpa.hibernate.ddl-auto=update
spring.jpa.properties.hibernate.format_sql=true

# ===== Logging =====
logging.level.org.hibernate.SQL=warn
logging.level.org.flywaydb=info

# ===== Server port =====
server.port=8080

# ===== JWT konfiguratsiyasi =====
app.jwt.secret=E+8Uzq4a6jWZjrFQ6HCvymM7d0yPSO1Z+5s3iTlDcH2YgKbXQv1LFNwC7/Moh+6UGKm4/NBYQr8d7jJkVYtEXJw==
# Access token muddati (5 daqiqa)
app.jwt.access-exp-minutes=5
# Refresh token muddati (1 kun)
app.jwt.refresh-exp-seconds=86400
# Issuer
app.jwt.issuer=mapapp

# Flyway sozlamalari
spring.flyway.baseline-on-migrate=true
spring.flyway.baseline-version=1


# ===== Refresh siyosati =====
# true => har refreshda eski refresh token rotate/revoke qilinadi
# false => eski refresh token qayta ishlatiladi
app.security.refresh.rotate=true
# Refreshni qaysi IP dan olgan bo?lsa, o?sha IPdan kelgan so?rovgina qabul qilinadi
app.security.refresh.ip-binding.enabled=true
# User-Agent binding (strict|lenient)
app.security.refresh.ua-binding.enabled=true
app.security.refresh.ua-binding.mode=lenient
# Token hash uchun salt (productionda o'zgartiring)
app.security.refresh.hash-salt=please-change-in-prod

# ===== Single-device siyosati =====
app.security.sessions.single-device.enabled=true
# REVOKE_OLD => yangi kirishda eskilarni avtomatik bekor qiladi
# REJECT_NEW => aktiv sessiya bo?lsa, yangi login rad qilinadi
app.security.sessions.single-device.policy=REVOKE_OLD

# ===== Rate-limit (IP bo?yicha) =====
app.security.ratelimit.login.max-requests=10
app.security.ratelimit.login.window-seconds=60
app.security.ratelimit.refresh.max-requests=30
app.security.ratelimit.refresh.window-seconds=60

# ===== Distributed ratelimit =====
app.security.ratelimit.distributed.enabled=true
app.security.ratelimit.bucket4j.enabled=true

# ===== Redis ulanishlari =====
spring.data.redis.host=localhost
spring.data.redis.port=6379
# spring.data.redis.password=
# spring.data.redis.database=0
spring.data.redis.timeout=5s

# ===== Offline CAPTCHA =====
app.captcha.enabled=true
app.captcha.length=5
app.captcha.ttl-seconds=120
app.captcha.width=160
app.captcha.height=60

# ===== Swagger (faqat dev/test profilda) =====
springdoc.api-docs.enabled=true
springdoc.swagger-ui.enabled=true
springdoc.swagger-ui.path=/swagger-ui.html
springdoc.api-docs.path=/api-docs

# ===== CORS =====
app.cors.enabled=true
app.cors.allowed-origins=http://localhost:5173
app.cors.allowed-methods=GET,POST,PATCH,DELETE,OPTIONS
# "*" desak X-Device-Id / Authorization va barchasi ruxsat
app.cors.allowed-headers=*
app.cors.exposed-headers=Authorization
# HttpOnly cookie yuborish uchun credentiallarni yoqing
app.cors.allow-credentials=true
